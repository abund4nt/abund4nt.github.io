<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Lukas Blog</title>
    <link>https://blog.lukas.re/</link>
    <description>Recent content on Lukas Blog</description>
    <generator>Hugo 0.138.0</generator>
    <language>en-us</language>
    <lastBuildDate>Tue, 05 Aug 2025 00:00:00 +0000</lastBuildDate>
    <atom:link href="https://blog.lukas.re/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Solving the Secure Code Review Challenges by dub-flow</title>
      <link>https://blog.lukas.re/post/secure-code-review-challenges/</link>
      <pubDate>Tue, 05 Aug 2025 00:00:00 +0000</pubDate>
      <guid>https://blog.lukas.re/post/secure-code-review-challenges/</guid>
      <description>&lt;p&gt;In this post, we’ll go through and solve all the challenges from the Secure Code Review Challenges repository by dub-flow. These exercises are designed to test and improve your ability to spot and understand common security issues in source code. Whether you’re just getting started or sharpening your review skills, this walkthrough will guide you step by step through each challenge.&lt;/p&gt;&#xA;&lt;center&gt;&lt;img src=&#34;https://blog.lukas.re/images/secure-code-challenges/dubflow.png&#34; width=550px&gt;&lt;/center&gt;&#xA;&lt;h2 id=&#34;challenge-01&#34;&gt;challenge-01&lt;/h2&gt;&#xA;&lt;p&gt;We are given the source code of a web application written in Python.&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; flask &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; Flask, request, redirect, url_for&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; logging&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;app &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Flask(__name__)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;logging&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;basicConfig(level&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;logging&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;INFO)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;is_authenticated_user&lt;/span&gt;():&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;# This function checks if the user is authenticated and is omitted for brevity&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;pass&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;@app.route&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;home&lt;/span&gt;():&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;not&lt;/span&gt; is_authenticated_user():&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        logging&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;info(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Unauthorized access attempt.&amp;#39;&lt;/span&gt;)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; redirect(url_for(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;login&amp;#39;&lt;/span&gt;))&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    redirect_url &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; request&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;args&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;get(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;redirect_url&amp;#39;&lt;/span&gt;)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; redirect_url:&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        logging&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;info(&lt;span style=&#34;color:#e6db74&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Redirecting to: &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{&lt;/span&gt;redirect_url&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&lt;/span&gt;)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; redirect(redirect_url)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Welcome to the home page!&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;@app.route&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;/login&amp;#39;&lt;/span&gt;)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;login&lt;/span&gt;():&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;# Simulated login page&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Login Page - User authentication goes here.&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; __name__ &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;:&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    app&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;run(debug&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;False&lt;/span&gt;)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This is a web application built using the Flask framework. It defines a function called &lt;code&gt;is_authenticated_user&lt;/code&gt;, which is omitted from the code since it is not relevant for this context. The application has tho main routes: the root route (&lt;code&gt;/&lt;/code&gt;), which serves as the home page, and the &lt;code&gt;/login&lt;/code&gt; route, which simulates a login page for user authentication.&lt;/p&gt;&#xA;&lt;p&gt;The key logic is within the home route. If the user is not authenticated, the aplication logs an unauthorized acces attempt and redirects the user to the login page. If the user is authenticated and a &lt;code&gt;redirect_url&lt;/code&gt; parameter is present in the request, the application logs the redirection and forwards the user to that specified URL. Otherwhise, ti simply returns a welcome message.&lt;/p&gt;&#xA;&lt;h2 id=&#34;challenge-02&#34;&gt;challenge-02&lt;/h2&gt;&#xA;&lt;p&gt;We are given th source code of a web application written in JavaScript.&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;express&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;require&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;express&amp;#39;&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;axios&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;require&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;axios&amp;#39;&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;app&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;express&lt;/span&gt;();&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;app&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;get&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;/profile&amp;#39;&lt;/span&gt;, (&lt;span style=&#34;color:#a6e22e&#34;&gt;req&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;res&lt;/span&gt;) =&amp;gt; {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;console&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;log&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Received request for /profile&amp;#39;&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;// Simulated profile data&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;profileData&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;John Doe&amp;#39;&lt;/span&gt;,&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;role&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Developer&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    };&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;res&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;json&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;profileData&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;console&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;log&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Sent profile data response&amp;#39;&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;});&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;app&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;get&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;/fetch-data&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; (&lt;span style=&#34;color:#a6e22e&#34;&gt;req&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;res&lt;/span&gt;) =&amp;gt; {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;url&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;req&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;query&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;url&lt;/span&gt;;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;console&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;log&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;`Received request for /fetch-data with URL: &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;url&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;`&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;try&lt;/span&gt; {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;response&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;axios&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;get&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;url&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;res&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;send&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;response&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;data&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;console&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;log&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;`Data fetched and sent for URL: &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;url&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;`&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    } &lt;span style=&#34;color:#66d9ef&#34;&gt;catch&lt;/span&gt; (&lt;span style=&#34;color:#a6e22e&#34;&gt;error&lt;/span&gt;) {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;console&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;error&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;`Error fetching data from URL: &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;url&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;`&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;error&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;res&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;status&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;500&lt;/span&gt;).&lt;span style=&#34;color:#a6e22e&#34;&gt;send&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Error fetching data&amp;#39;&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;});&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;app&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;listen&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;3000&lt;/span&gt;, () =&amp;gt; {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;console&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;log&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Server running on port 3000&amp;#39;&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;});&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This is a web application built using the Express framework. It defines two main routes: &lt;code&gt;/profiles&lt;/code&gt;, which returns simulated user profile data as JSON, and &lt;code&gt;/fetch-data&lt;/code&gt;, which accepts a &lt;code&gt;url&lt;/code&gt; parameter via the query string and fetches data from that URL using the Axios library.&lt;/p&gt;&#xA;&lt;p&gt;The key issue lies within &lt;code&gt;/fetch-data&lt;/code&gt; route. It takes the &lt;code&gt;url&lt;/code&gt; parameter directly from the user request without any validation or restrictions and uses it to make and HTTP GET request. This allows an attacker to supply aribitrary URLs, potentially causing the server to request internal or sensitive resources whithin a private network, a vulnerability known as Server-Side Request Forgery (SSRF). As a result, the attacker can exploit this to access protected internal services or malicious endpoints.&lt;/p&gt;&#xA;&lt;p&gt;To exploit this, we can use the curl command and send the url parameter with any URL we want in the request. We can see that the server fetches and returns the data from that URL. Unlike an open redirect, if we point it to an internal address, the server will actually resolve and fetch it. In this example, I didn’t test that, but it is possible.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;font color=&#34;#CC0000&#34;&gt;&lt;b&gt;$&lt;/b&gt;&lt;/font&gt; curl http://localhost:3000/fetch-data\?url\=https://blog.lukas.re/&#xA;&amp;lt;!DOCTYPE html&amp;gt;&#xA;&amp;lt;html lang=&amp;quot;en&amp;quot;&amp;gt;&#xA;    &amp;lt;head&amp;gt;&#xA;    &amp;lt;meta charset=&amp;quot;utf-8&amp;quot;&amp;gt;&#xA;    &amp;lt;meta name=&amp;quot;viewport&amp;quot; content=&amp;quot;width=device-width, initial-scale=1.0&amp;quot;&amp;gt;&#xA;    &amp;lt;meta name=&amp;quot;generator&amp;quot; content=&amp;quot;Hugo 0.138.0&amp;quot;&amp;gt;&#xA;    &amp;lt;title&amp;gt;Lukas Blog&amp;lt;/title&amp;gt;&amp;lt;link rel=&amp;quot;stylesheet&amp;quot; href=&amp;quot;https://blog.lukas.re/css/colors-default-dark.css&amp;quot;&amp;gt;&#xA;    &amp;lt;link rel=&amp;quot;stylesheet&amp;quot; href=&amp;quot;https://blog.lukas.re/css/style.css&amp;quot;&amp;gt;&#xA;    &amp;lt;link rel=&amp;quot;alternate&amp;quot; type=&amp;quot;application/rss+xml&amp;quot; href=&amp;quot;https://blog.lukas.re/index.xml&amp;quot; title=&amp;quot;Lukas Blog&amp;quot;&amp;gt;&#xA;    &#xA;&amp;lt;/head&amp;gt;&#xA;&#xA;    &amp;lt;body&amp;gt;&#xA;        &amp;lt;div class=&amp;quot;site-content&amp;quot;&amp;gt;&#xA;            &amp;lt;header&amp;gt;&#xA;                &amp;lt;div class=&amp;quot;header-container&amp;quot;&amp;gt;&#xA;    &amp;lt;div class=&amp;quot;site-header&amp;quot;&amp;gt;&#xA;        &amp;lt;a class=&amp;quot;site-header&amp;quot; href=&amp;quot;https://blog.lukas.re/&amp;quot;&amp;gt;Lukas Blog&amp;lt;/a&amp;gt;&#xA;    &amp;lt;/div&amp;gt;&#xA;    &amp;lt;div class=&amp;quot;site-nav&amp;quot;&amp;gt;&#xA;        &amp;lt;nav aria-label=&amp;quot;Site menu&amp;quot; class=&amp;quot;site-nav&amp;quot;&amp;gt;&amp;lt;a class=&amp;quot;nav-item first&amp;quot; href=&amp;quot;/post/&amp;quot;&amp;gt;posts&amp;lt;/a&amp;gt;&amp;lt;a class=&amp;quot;nav-item last&amp;quot; href=&amp;quot;/about/&amp;quot;&amp;gt;about&amp;lt;/a&amp;gt;&#xA;        &amp;lt;/nav&amp;gt;&#xA;    &amp;lt;/div&amp;gt;&#xA;&amp;lt;/div&amp;gt;&#xA;&#xA;            &amp;lt;/header&amp;gt;&#xA;            &amp;lt;main class=&amp;quot;content&amp;quot;&amp;gt;&#xA;                &#xA;&amp;lt;img alt=&amp;quot;Ellingson Mineral Company&amp;quot; style=&amp;quot;display:block;margin-left:auto;margin-right:auto;max-width:100%;height:auto;&amp;quot; src=&amp;quot;images/i.png&amp;quot;&amp;gt;&#xA;&amp;lt;p&amp;gt;&amp;lt;strong&amp;gt;Welcome to my blog!&amp;lt;/strong&amp;gt;&amp;lt;/p&amp;gt;&#xA;&amp;lt;p&amp;gt;Here you&amp;amp;rsquo;ll find content about cybersecurity, AI, personal projects, and more.&amp;lt;/p&amp;gt;&#xA;&#xA;&#xA;            &amp;lt;/main&amp;gt;&#xA;            &amp;lt;footer&amp;gt;&amp;lt;div class=&amp;quot;footer-container&amp;quot;&amp;gt;&#xA;    &amp;lt;div class=&amp;quot;h-card bio&amp;quot;&amp;gt;&#xA;&amp;lt;p&amp;gt;&#xA;    &amp;lt;a class=&amp;quot;u-url&amp;quot; href=&amp;quot;https://blog.lukas.re/&amp;quot;&amp;gt;Lukas Blog&amp;lt;/a&amp;gt;&#xA;    created by &amp;lt;img class=&amp;quot;u-photo&amp;quot; alt=&amp;quot;&amp;quot; src=&amp;quot;https://blog.lukas.re/images/i.jpg&amp;quot;&amp;gt; &amp;lt;span class=&amp;quot;p-name&amp;quot; rel=&amp;quot;me&amp;quot;&amp;gt;Lukas Gaete&amp;lt;/span&amp;gt;&#xA;        (&amp;lt;span class=&amp;quot;u-pronoun&amp;quot;&amp;gt;they&amp;lt;/span&amp;gt;/&amp;lt;span class=&amp;quot;u-pronoun&amp;quot;&amp;gt;them&amp;lt;/span&amp;gt; pronouns.&#xA;&amp;lt;/p&amp;gt;&#xA;&#xA;&amp;lt;/div&amp;gt;&amp;lt;div class=&amp;quot;footer-text footer-right&amp;quot;&amp;gt;&#xA;        &amp;lt;p&amp;gt;&#xA;            Stay focus 🧠.&#xA;        &amp;lt;/p&amp;gt;&#xA;    &amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&#xA;&amp;lt;div class=&amp;quot;h-card social&amp;quot;&amp;gt;&#xA;    &amp;lt;a class=&amp;quot;u-url&amp;quot; rel=&amp;quot;me&amp;quot; aria-label=&amp;quot;email&amp;quot; href=&amp;quot;/cdn-cgi/l/email-protection#026360776c66366c764272706d766d6c2c6f67&amp;quot;&amp;gt;&amp;lt;span class=&amp;quot;social-icon&amp;quot; &amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/a&amp;gt;&#xA;&amp;lt;a class=&amp;quot;u-url&amp;quot; rel=&amp;quot;me&amp;quot; aria-label=&amp;quot;github&amp;quot; href=&amp;quot;https://github.com/abund4nt&amp;quot;&amp;gt;&amp;lt;span class=&amp;quot;social-icon&amp;quot; &amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/a&amp;gt;&#xA;&amp;lt;/div&amp;gt;&#xA;&amp;lt;/footer&amp;gt;&#xA;        &amp;lt;/div&amp;gt;&#xA;    &amp;lt;script data-cfasync=&amp;quot;false&amp;quot; src=&amp;quot;/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;&amp;lt;/body&amp;gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>How to set up your Android Pentesting environment</title>
      <link>https://blog.lukas.re/post/set-up-your-android-pentesting-environment/</link>
      <pubDate>Mon, 03 Feb 2025 00:00:00 +0000</pubDate>
      <guid>https://blog.lukas.re/post/set-up-your-android-pentesting-environment/</guid>
      <description>&lt;h2 id=&#34;introduction&#34;&gt;Introduction&lt;/h2&gt;&#xA;&lt;p&gt;As cybersecurity consultants, it&amp;rsquo;s pretty common to come across Android apps that need to be audited. In this short post, I’ll show you a quick and easy way to set up your own lab to make things smoother. I’ll also share some tips on how I usually approach Android app pentesting and what I like to focus on during an assessment.&lt;/p&gt;&#xA;&lt;p&gt;A bit of theory never hurts, so here we go: First, it&amp;rsquo;s important to understand that Android applications come in .apk format. This format is a variation of Java’s .jar files and is used to package and distribute components for Android devices. Basically, an APK is just a compressed ZIP file with a different extension, which means it can be opened and inspected using any archive tool — something we’ll look at later on.&lt;/p&gt;&#xA;&lt;p&gt;This basic understanding of APK structure will come in handy as we start interacting with real applications, modifying their behavior, and inspecting their logic. Before we get to that point, though, we need to make sure our environment is properly configured.&lt;/p&gt;&#xA;&lt;h2 id=&#34;create-environment&#34;&gt;Create environment&lt;/h2&gt;&#xA;&lt;p&gt;To set up our Android pentesting lab, we need to have the following tools installed:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Genymotion&lt;/li&gt;&#xA;&lt;li&gt;Frida&lt;/li&gt;&#xA;&lt;li&gt;Burp Suite&lt;/li&gt;&#xA;&lt;li&gt;JADX&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Each of these tools plays a key role during the assessment process. Genymotion is an Android emulator that allows us to run virtual devices for testing in a controlled environment — it&amp;rsquo;s fast, flexible, and supports root access. Frida is a powerful dynamic instrumentation toolkit that lets us hook into running processes, modify app behavior on the fly, and bypass security checks like root or SSL pinning. Burp Suite acts as our intercepting proxy, enabling us to analyze and manipulate HTTP/HTTPS traffic between the app and backend services. Finally, JADX is a decompiler that allows us to convert APKs into readable Java code, making it easier to understand the app’s logic and look for hardcoded secrets, insecure API usage, or potential vulnerabilities&lt;/p&gt;&#xA;&lt;p&gt;First of all, we’re going to create two virtual devices in Genymotion — one running Android 11 and another running Android 13.0 (which is currently the highest version available in Genymotion). The reason for this setup is that, due to a recent update, Genymotion only provides root access up to Android 11. For versions above that, root access is no longer available.&lt;/p&gt;&#xA;&lt;center&gt;&lt;img src=&#34;https://i.postimg.cc/VsjgpTBy/image.png&#34;/&gt;&lt;/center&gt;&#xA;&lt;p&gt;Personally, I use the Android 11 device most of the time, since it allows me to hook and test apps freely. However, when I come across an app with strong anti-root protections that I can&amp;rsquo;t bypass easily, I switch to the Android 13.0 device to continue the analysis without root interference.&lt;/p&gt;&#xA;&lt;p&gt;Let’s start by booting up the Android 11 virtual device and opening Burp Suite. Using the following commands, we’ll extract the Burp certificate, install it on the device, and route all traffic through the proxy.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Make sure the Burp proxy listener is configured to bind to all interfaces (*).&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;pre&gt;&lt;font color=&#34;#CC0000&#34;&gt;&lt;b&gt;$&lt;/b&gt;&lt;/font&gt; curl localhost:8080/cert -o cert.der&#xA;&lt;font color=&#34;#CC0000&#34;&gt;&lt;b&gt;$&lt;/b&gt;&lt;/font&gt; openssl x509 -inform der -in cert.der -out cert.pem&#xA;&lt;font color=&#34;#CC0000&#34;&gt;&lt;b&gt;$&lt;/b&gt;&lt;/font&gt; openssl x509 -inform PEM -subject_hash_old -in certificado.pem | head -1&#xA;&lt;font color=&#34;#CC0000&#34;&gt;&lt;b&gt;$&lt;/b&gt;&lt;/font&gt; mv cert.pem 9a5ba575.0&#xA;&lt;font color=&#34;#CC0000&#34;&gt;&lt;b&gt;$&lt;/b&gt;&lt;/font&gt; adb shell&#xA;vbox86p:/ # su&#xA;1|:/ # mount -o remount,rw /                                                   &#xA;:/ # exit&#xA;vbox86p:/ # exit&#xA;&lt;font color=&#34;#CC0000&#34;&gt;&lt;b&gt;$&lt;/b&gt;&lt;/font&gt; adb push 9a5ba575.0 /system/etc/security/cacerts/&#xA;&lt;/pre&gt;&#xA;&lt;p&gt;In this step, we gain root access to the Android emulator using adb shell and su, then remount the root filesystem with read/write permissions (mount -o remount,rw /) to allow modifications. After that, we use adb push to copy the Burp Suite certificate (9a5ba575.0) into the system&amp;rsquo;s trusted CA store located at /system/etc/security/cacerts/, enabling the device to trust our proxy and properly intercept HTTPS traffic.&lt;/p&gt;&#xA;&lt;p&gt;Now we need to set up the proxy on the Android device. To do that, we first need to get our local IP address — you can use &lt;code&gt;ifconfig&lt;/code&gt; or &lt;code&gt;ip a&lt;/code&gt; for that. Once you have your local IP, run the following command to configure the proxy on the emulator:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;font color=&#34;#CC0000&#34;&gt;&lt;b&gt;$&lt;/b&gt;&lt;/font&gt; adb shell settings put global http_proxy 192.168.1.82:8080&lt;/pre&gt;&#xA;&lt;p&gt;This tells the Android system to route all HTTP and HTTPS traffic through the specified proxy — in this case, Burp Suite running on port 8080 of your local machine. Now, if you open a browser on the device and search for anything on Google, you should see the traffic being intercepted in Burp Suite.&lt;/p&gt;&#xA;&lt;center&gt;&lt;img src=&#34;https://i.postimg.cc/XJ5RT8x2/image.png&#34;/&gt;&lt;/center&gt;&#xA;&lt;h2 id=&#34;set-frida&#34;&gt;Set Frida&lt;/h2&gt;&#xA;&lt;p&gt;If we’re going to audit an app that doesn’t implement SSL pinning or root detection, we can start right away with the setup we just configured. All we need to do is install the app and start analyzing the network traffic.&lt;/p&gt;&#xA;&lt;p&gt;But things won’t always be smooth — more often than not, we’ll run into apps with protection mechanisms like SSL pinning, root detection, and more. That’s where Frida comes in.&lt;/p&gt;&#xA;&lt;p&gt;Frida is a dynamic instrumentation toolkit that lets us inject JavaScript into running processes, giving us the ability to bypass or modify app behavior at runtime. With Frida, we can hook into specific functions, disable root checks, bypass SSL pinning, monitor internal function calls, and even modify return values — all without needing to recompile the APK. It&amp;rsquo;s one of the most powerful tools in mobile app pentesting, especially when dealing with hardened apps.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;If you’re not familiar with the concepts of SSL pinning and root detection, I recommend checking out these two articles: &lt;a href=&#34;https://www.indusface.com/learning/what-is-ssl-pinning-a-quick-walk-through/1&#34;&gt;1&lt;/a&gt;, &lt;a href=&#34;https://www.security-garage.com/es/introduccion-al-hacking/bypassing-android-app-security-in-3-2-1-pwned-defeating-root-control-detection&#34;&gt;2&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;To use Frida on the Android device, we need to install &lt;a href=&#34;https://github.com/frida/frida/releases/tag/17.2.14&#34;&gt;frida-server&lt;/a&gt; on the emulator or physical device. This binary must match the architecture of the Android system (usually x86 for Genymotion or arm64 for real devices). Once downloaded, we push it to the device and run it in the background with the following commands:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;font color=&#34;#CC0000&#34;&gt;&lt;b&gt;$&lt;/b&gt;&lt;/font&gt; adb push frida-server /data/local/tmp/&#xA;&lt;font color=&#34;#CC0000&#34;&gt;&lt;b&gt;$&lt;/b&gt;&lt;/font&gt; adb shell &amp;quot;chmod +x &amp;apos;/data/local/tmp/frida-server&amp;apos;&amp;quot;&#xA;&lt;font color=&#34;#CC0000&#34;&gt;&lt;b&gt;$&lt;/b&gt;&lt;/font&gt; adb shell &amp;quot;su -c &amp;apos;/data/local/tmp/frida-server &amp;amp;&amp;apos;&amp;quot;&lt;/pre&gt;&#xA;&lt;p&gt;This sets the correct permissions and runs Frida with root privileges in the background, allowing us to start injecting scripts into apps from our host machine using the Frida CLI or Python bindings.&lt;/p&gt;&#xA;&lt;p&gt;Once Frida is up and running on the phone, we can start using it to hook and modify the behavior of applications in real time. As an example, we&amp;rsquo;ll bypass the root detection protection of an app called fridaen45minutos. This application was created by some colleagues specifically for a talk, and it includes basic checks to prevent execution on rooted devices. You can download it &lt;a href=&#34;https://github.com/TaconeoMental/frida-en-45-minutos&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;&#xA;&lt;p&gt;If we install the app on our phone and try to launch it, we’ll quickly notice that it doesn’t allow us to proceed — that’s because the device is rooted. The app detects the root status and immediately blocks access as a security measure. This behavior is exactly what we’ll be targeting and bypassing with Frida.&lt;/p&gt;&#xA;&lt;center&gt;&lt;img src=&#34;https://i.postimg.cc/43BwG2cj/imagen.png&#34;/&gt;&lt;/center&gt;&#xA;&lt;h2 id=&#34;evasion-of-anti-root-control&#34;&gt;Evasion of anti-root control&lt;/h2&gt;&#xA;&lt;p&gt;Now we’re going to use a Frida script designed to bypass the root detection mechanisms implemented in the application. Once we hook into the app’s process and inject the script, Frida will override the methods responsible for performing root checks at runtime, effectively disabling the protection. This allows us to run and interact with the application on a rooted device without being blocked.&lt;/p&gt;&#xA;&lt;p&gt;The script is included in the repository of the &lt;a href=&#34;https://github.com/TaconeoMental/frida-en-45-minutos/tree/main&#34;&gt;frida-en-45-minutos&lt;/a&gt; application, so you can find it there and use it directly:&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;Java&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;available&lt;/span&gt;){&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;Java&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;perform&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt;(){&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;console&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;log&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;rootCheckerClass&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Java&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;use&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;com.nivel4.RootChecker.rootChecker&amp;#34;&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;rootCheckerClass&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;checkSu&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;implementation&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt;() {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#a6e22e&#34;&gt;console&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;log&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;checkSu returned&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;checkSu&lt;/span&gt;());&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;rootCheckerClass&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;testKeys&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;implementation&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt;() {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#a6e22e&#34;&gt;console&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;log&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;testKeys returned&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;testKeys&lt;/span&gt;());&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#a6e22e&#34;&gt;rootCheckerClass&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;checkPackages&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;implementation&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt;() {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#a6e22e&#34;&gt;console&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;log&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;checkPackages returned&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;checkPackages&lt;/span&gt;());&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    })&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;To find the app&amp;rsquo;s identifier (package name), we can run the following command:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;font color=&#34;#CC0000&#34;&gt;&lt;b&gt;$&lt;/b&gt;&lt;/font&gt; frida-ps -Uai&#xA; PID  Name                  Identifier                      &#xA;----  --------------------  --------------------------------&#xA;6429  Files                 com.android.documentsui         &#xA;6366  Google Play Store     com.android.vending             &#xA;3556  Phone                 com.android.dialer              &#xA;7039  fridaen45minutos      com.nivel4.fridaen45minutos     &#xA;   -  Amaze                 com.amaze.filemanager           &#xA;   -  Aptoide               cm.aptoide.pt                   &#xA;   -  Calendar              com.android.calendar            &#xA;   -  Camera                com.android.camera2             &#xA;   -  Clock                 com.android.deskclock           &#xA;   -  Contacts              com.android.contacts            &#xA;   -  Custom Locale         com.android.customlocale2       &#xA;   -  Dev Tools             com.android.development         &#xA;   -  Development Settings  com.android.development_settings&#xA;   -  Gallery               com.android.gallery3d           &#xA;   -  JokesPhone            com.cashitapp.app.jokesphone    &#xA;   -  Messaging             com.android.messaging           &#xA;   -  Neatpagos             com.neat.mobileappprod          &#xA;   -  Search                com.android.quicksearchbox      &#xA;   -  Settings              com.android.settings            &#xA;   -  Superuser             com.genymotion.superuser        &#xA;   -  WebView Shell         org.chromium.webview_shell&lt;/pre&gt;&#xA;&lt;p&gt;Once we have the correct identifier (in this case, com.nivel4.fridaen45minutos), we can load the script into the running app by executing:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;font color=&#34;#CC0000&#34;&gt;&lt;b&gt;$&lt;/b&gt;&lt;/font&gt; frida -U -f com.nivel4.fridaen45minutos -l antiroot.js&#xA;     ____&#xA;    / _  |   Frida 16.5.2 - A world-class dynamic instrumentation toolkit&#xA;   | (_| |&#xA;    &amp;gt; _  |   Commands:&#xA;   /_/ |_|       help      -&amp;gt; Displays the help system&#xA;   . . . .       object?   -&amp;gt; Display information about &amp;apos;object&amp;apos;&#xA;   . . . .       exit/quit -&amp;gt; Exit&#xA;   . . . .&#xA;   . . . .   More info at https://frida.re/docs/home/&#xA;   . . . .&#xA;   . . . .   Connected to Pixel (id=127.0.0.1:6555)&#xA;&lt;b&gt;Spawned `com.nivel4.fridaen45minutos`. Resuming main thread!&lt;/b&gt;            &#xA;[Pixel::com.nivel4.fridaen45minutos ]-&amp;gt;&#xA;checkSu returned true&#xA;checkPackages returned true&#xA;testKeys returned true&lt;/pre&gt;&#xA;&lt;p&gt;This will inject the script and hook the necessary functions to disable the app’s root detection. After that, if we launch the app on a rooted device, it will no longer block access. This confirms that the anti-root bypass was successful, allowing us to interact with the application freely despite the device being rooted.&lt;/p&gt;&#xA;&lt;center&gt;&lt;img src=&#34;https://i.postimg.cc/02YB3ft1/imagen.png&#34;&gt;&lt;/center&gt;&#xA;&lt;p&gt;In the previous example, we saw how Frida combined with a custom script can effectively bypass the root detection mechanisms of an application. This approach allows security testers to analyze and interact with apps that would otherwise refuse to run on rooted devices, opening the door to deeper inspection and testing.&lt;/p&gt;&#xA;&lt;h2 id=&#34;reverse-engineering&#34;&gt;Reverse Engineering&lt;/h2&gt;&#xA;&lt;p&gt;If we need to perform reverse engineering on the APK, one of the most useful tools is Jadx. After installing it, you’ll find a binary called jadx-gui, which launches the graphical interface of the tool — making it easier to explore the app’s internals visually.&lt;/p&gt;&#xA;&lt;p&gt;To get started, simply open jadx-gui, click on &amp;ldquo;File&amp;rdquo; &amp;gt; &amp;ldquo;Open&amp;rdquo;, and select the APK you want to analyze. Jadx will automatically decompile the DEX (Dalvik Executable) files inside the APK and present you with a Java-like source code view. You’ll be able to browse through the app’s package structure, classes, methods, and resources like AndroidManifest.xml, layouts, and strings.&lt;/p&gt;&#xA;&lt;center&gt;&lt;img src=&#34;https://i.postimg.cc/PxPXN9h2/image.png&#34;&gt;&lt;/center&gt;&#xA;&lt;p&gt;This is extremely useful for understanding how the app works under the hood, identifying potential attack surfaces (such as hardcoded API keys, exposed components, insecure logic), and mapping out where you might want to hook or patch with tools like Frida.&lt;/p&gt;&#xA;&lt;p&gt;While Jadx doesn’t produce 100% accurate Java code (since it&amp;rsquo;s decompiled from bytecode), it&amp;rsquo;s more than enough for static analysis and planning dynamic testing.&lt;/p&gt;&#xA;&lt;p&gt;In summary: We went through how to set up an environment for mobile app testing, how to configure a proxy to intercept traffic, and how to use Frida to bypass common protections when needed.&lt;/p&gt;&#xA;&lt;p&gt;Now, I’d like to share some personal tips based on my experience — things that help me perform effective analysis and find interesting vulnerabilities in a short amount of time (because let’s be honest, we rarely have unlimited time during an audit).&lt;/p&gt;&#xA;&lt;h2 id=&#34;tips&#34;&gt;Tips&lt;/h2&gt;&#xA;&lt;p&gt;The first thing I usually do is open the APK in jadx-gui and look for any exposed or leaked information — such as hardcoded API keys, credentials, internal endpoints, or file paths. Once I get a general idea of the app’s structure, I install the APK on an emulator and check if it implements security protections like SSL Pinning or Root Detection.&lt;/p&gt;&#xA;&lt;p&gt;If the app has no protections in place — lucky day! — I jump straight into the ethical hacking phase. But if those protections are present, I try to bypass them using Frida scripts. If the scripts don’t work, then it’s time to go manual — which is great for learning. If you&amp;rsquo;re interested in learning how to do it manually, I highly recommend this &lt;a href=&#34;https://www.youtube.com/watch?v=lFcmen66qe4&#34;&gt;talk&lt;/a&gt; (given by some good friends of mine — absolute pros, by the way).&lt;/p&gt;&#xA;&lt;p&gt;Once the protections are bypassed, I treat the mobile app just like I would a web application. Most mobile apps interact with backend APIs, especially when there’s a login mechanism involved, so the approach becomes very similar to classic API pentesting.&lt;/p&gt;&#xA;&lt;p&gt;In general, I focus heavily on business logic flaws, injection points, and poor client-side control of iterations, parameters, or flows. I also use multiple mobile testing checklists and guides to make sure I cover as much ground as possible and get the highest value findings in the time I have.&lt;/p&gt;&#xA;</description>
    </item>
    <item>
      <title>about</title>
      <link>https://blog.lukas.re/about/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://blog.lukas.re/about/</guid>
      <description>&lt;p&gt;Redirecting&amp;hellip;&lt;/p&gt;&#xA;&lt;script&gt;location.href = &#39;https://lukas.re&#39;;&lt;/script&gt;&#xA;</description>
    </item>
  </channel>
</rss>

